# Workflow to run integration tests
# Checks that check_cla workflow works as expected

name: CLA Integration Tests

on:
  push:
    branches-ignore:
      - integration-test-**
    paths:
      - .github/custom_python_actions/check_cla_issue.py
      - .github/custom_python_actions/check_cla_pr.py
      - .github/tests/test_cla_issue.py
      - .github/tests/test_cla_pr.py
      - .github/workflows/check_cla.yml
      - .github/workflows/cla_integration_tests.yml
      - .github/integration_tests/trigger_cla.sh
  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:

jobs:
  integration-test:
    name: CLA Integration Test
    runs-on: ubuntu-latest
    steps:
    - name: Checkout
      uses: actions/checkout@v3 

    - name: Trigger CLA workflow
      run: ${GITHUB_WORKSPACE}/.github/integration_tests/trigger_cla.sh 
      env:
        AUTH_TOKEN: ${{ secrets.INTEGRATION_TESTS_RUN_WORKFLOW }}

